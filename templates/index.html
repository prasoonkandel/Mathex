<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mathex - Modern Math Tools</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='root.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='home.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='solver.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='quiz.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='quotes.css') }}"
    />
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["$", "$"],
            ["\\(", "\\)"],
          ],
          displayMath: [
            ["$$", "$$"],
            ["\\[", "\\]"],
          ],
        },
      };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
  </head>
  <body>
    <nav>
      <div class="nav-container">
        <a href="#" class="logo" data-page="home">Mathex</a>
        <button class="hamburger" id="hamburger" aria-label="Menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
        <ul class="nav-links" id="navLinks">
          <li><a href="#" data-page="home">Home</a></li>
          <li><a href="#" data-page="solver">Solver</a></li>
          <li><a href="#" data-page="quiz">Quiz</a></li>
          <li><a href="#" data-page="quotes">Quotes</a></li>
          <li>
            <button
              class="theme-toggle"
              id="themeToggle"
              aria-label="Toggle theme"
            >
              üåô
            </button>
          </li>
        </ul>
      </div>
    </nav>

    <section id="page-home" class="page-section active">
      <main>
        <section class="hero">
          <h1>Mathex</h1>
          <span class="slogan">Tool built by Student for Students</span>
          <p>
            Mathex is a collection of AI-powered math tools designed to help
            students excel in their studies. It includes a math problem solver
            and a quiz generator to make learning math easier and more engaging.
            Students can use mathex to learn new things by doing experiments and
            solving problems.
          </p>
          <a href="#tools" class="cta-button">Explore Tools</a>
        </section>

        <section class="tools-section" id="tools">
          <h2>Our Tools</h2>
          <div class="tools-grid">
            <div class="tool-card">
              <h3>Math Solver</h3>
              <p>
                Get step-by-step solutions to complex math problems. From
                algebra to calculus, we've got you covered.
              </p>
              <a href="#" data-page="solver" class="tool-link">Try Solver ‚Üí</a>
            </div>

            <div class="tool-card">
              <h3>Quiz Generator</h3>
              <p>
                Create customized quizzes for any grade level and topic. Perfect
                for studying and practice.
              </p>
              <a href="#" data-page="quiz" class="tool-link">Generate Quiz ‚Üí</a>
            </div>

            <div class="tool-card">
              <h3>Math Quotes</h3>
              <p>
                Get inspired with mathematical insights and quotes from famous
                mathematicians and thinkers. Take a moment to appreciate the
                beauty of math.
              </p>
              <a href="#" data-page="quotes" class="tool-link">Go ahead ‚Üí</a>
            </div>
          </div>
        </section>
      </main>
    </section>

    <section id="page-solver" class="page-section">
      <div class="content">
        <div class="container">
          <a href="#" data-page="home" class="back-to-home">‚Üê Back to Home</a>
          <h1>Math Solver</h1>
          <p class="subtitle">Enter your math problem below</p>

          <div class="symbols-section">
            <label class="symbols-label">Quick Symbols:</label>
            <div class="symbols-grid" id="symbolsGrid">
              <button type="button" class="symbol-btn" data-symbol="œÄ">
                œÄ
              </button>
              <button type="button" class="symbol-btn" data-symbol="‚àû">
                ‚àû
              </button>
              <button type="button" class="symbol-btn" data-symbol="‚àë">
                ‚àë
              </button>
              <button type="button" class="symbol-btn" data-symbol="‚à´">
                ‚à´
              </button>
              <button type="button" class="symbol-btn" data-symbol="‚àö">
                ‚àö
              </button>
              <button type="button" class="symbol-btn" data-symbol="¬≤">
                ¬≤
              </button>
              <button type="button" class="symbol-btn" data-symbol="¬≥">
                ¬≥
              </button>
              <button type="button" class="symbol-btn" data-symbol="‚â§">
                ‚â§
              </button>
              <button type="button" class="symbol-btn" data-symbol="‚â•">
                ‚â•
              </button>
              <button type="button" class="symbol-btn" data-symbol="‚â†">
                ‚â†
              </button>
              <button type="button" class="symbol-btn" data-symbol="¬±">
                ¬±
              </button>
              <button type="button" class="symbol-btn" data-symbol="√ó">
                √ó
              </button>
              <button type="button" class="symbol-btn" data-symbol="√∑">
                √∑
              </button>
              <button type="button" class="symbol-btn" data-symbol="¬∞">
                ¬∞
              </button>
              <button type="button" class="symbol-btn" data-symbol="‚àÜ">
                ‚àÜ
              </button>
              <button type="button" class="symbol-btn" data-symbol="Œ±">
                Œ±
              </button>
              <button type="button" class="symbol-btn" data-symbol="Œ≤">
                Œ≤
              </button>
              <button type="button" class="symbol-btn" data-symbol="Œ∏">
                Œ∏
              </button>
            </div>
          </div>

          <div id="inputArea">
            <form id="solverForm">
              <textarea
                id="question"
                placeholder="Enter your math problem here...&#10;&#10;Example: Solve x¬≤ + 5x + 6 = 0"
                required
              ></textarea>

              <button type="submit" id="submitBtn">Solve Problem</button>
            </form>
          </div>

          <div id="resultArea" style="display: none">
            <div id="result" class="result"></div>
            <button
              type="button"
              id="solveAnotherBtn"
              class="solve-another-btn"
            >
              Solve Another Problem
            </button>
          </div>
        </div>
      </div>
    </section>

    <section id="page-quiz" class="page-section">
      <div class="content">
        <div class="container">
          <a href="#" data-page="home" class="back-to-home">‚Üê Back to Home</a>
          <h1>Quiz Generator</h1>
          <p class="subtitle">Create a custom quiz for practice</p>

          <div id="setupScreen" class="screen active">
            <form id="quizForm">
              <label for="grade">Grade Level</label>
              <select id="grade" required>
                <option value="">Select Grade Level</option>
                <option value="1">Grade 1</option>
                <option value="2">Grade 2</option>
                <option value="3">Grade 3</option>
                <option value="4">Grade 4</option>
                <option value="5">Grade 5</option>
                <option value="6">Grade 6</option>
                <option value="7">Grade 7</option>
                <option value="8">Grade 8</option>
                <option value="9">Grade 9</option>
                <option value="10">Grade 10</option>
                <option value="11">Grade 11</option>
                <option value="12">Grade 12</option>
              </select>

              <label for="topic">Topic/Description</label>
              <textarea
                id="topic"
                placeholder="Enter the topic or description...&#10;&#10;Example: Algebra - Linear equations"
                required
              ></textarea>

              <button type="submit" id="quizSubmitBtn">Generate Quiz</button>
            </form>

            <div id="loadingMessage" class="loading-message"></div>
          </div>

          <div id="quizScreen" class="screen">
            <div class="quiz-header">
              <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
              </div>
              <div class="question-counter" id="questionCounter"></div>
            </div>

            <div id="questionContainer">
              <h2 id="questionText" class="question-text"></h2>
              <div id="optionsContainer" class="options-container"></div>
            </div>

            <div class="quiz-actions">
              <button id="nextBtn" class="btn-secondary">Next Question</button>
            </div>
          </div>

          <div id="resultsScreen" class="screen">
            <div class="results-container">
              <h2>Quiz Complete!</h2>
              <div class="score-display">
                <div class="score-circle">
                  <span id="finalScore" class="score-number">0</span>
                  <span class="score-label">Score</span>
                </div>
              </div>
              <div id="scoreSummary" class="score-summary"></div>
              <button id="retryBtn" class="btn-primary">
                Try Another Quiz
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="page-quotes" class="page-section">
      <div class="content">
        <div class="container">
          <a href="#" data-page="home" class="back-to-home">‚Üê Back to Home</a>
          <h1>Math Quotes</h1>
          <p class="subtitle">Get inspired by mathematical wisdom</p>

          <div class="quote-card">
            <div class="quote-icon">"</div>
            <p id="quoteText" class="quote-text">
              Click the button below to get a random math quote
            </p>
            <p id="quoteAuthor" class="quote-author"></p>
          </div>

          <button id="newQuoteBtn" class="btn-primary">Get New Quote</button>
        </div>
      </div>
    </section>

    <footer>Mathex | Built by Prasoon Kandel</footer>

    <script src="{{ url_for('static', filename='home.js') }}"></script>
    <script src="{{ url_for('static', filename='solver.js') }}"></script>
    <script src="{{ url_for('static', filename='quiz.js') }}"></script>
    <script>
      function showPage(pageName) {
        document.querySelectorAll(".page-section").forEach((section) => {
          section.classList.remove("active");
        });

        const pageSection = document.getElementById("page-" + pageName);
        if (pageSection) {
          pageSection.classList.add("active");
        }
        const hamburger = document.getElementById("hamburger");
        const navLinks = document.getElementById("navLinks");
        if (hamburger && navLinks) {
          hamburger.classList.remove("active");
          navLinks.classList.remove("active");
        }

        if (pageName === "quotes" && typeof getQuote === "function") {
          getQuote();
        }
      }

      document.addEventListener("click", (e) => {
        const target = e.target.closest("[data-page]");
        if (target) {
          e.preventDefault();
          const pageName = target.getAttribute("data-page");
          showPage(pageName);
        }
      });

      showPage("home");

      const quoteText = document.getElementById("quoteText");
      const quoteAuthor = document.getElementById("quoteAuthor");
      const newQuoteBtn = document.getElementById("newQuoteBtn");

      async function getQuote() {
        newQuoteBtn.disabled = true;
        newQuoteBtn.textContent = "Loading...";
        quoteText.style.opacity = "0.5";
        quoteAuthor.style.opacity = "0.5";

        try {
          const response = await fetch("/api/quotes");
          const data = await response.json();

          if (response.ok) {
            setTimeout(() => {
              quoteText.textContent = data.quote;
              quoteAuthor.textContent = "- " + data.author;
              quoteText.style.opacity = "1";
              quoteAuthor.style.opacity = "1";
            }, 200);
          } else {
            quoteText.textContent = "Error loading quote";
            quoteAuthor.textContent = "";
          }
        } catch (error) {
          quoteText.textContent = "Could not connect to server";
          quoteAuthor.textContent = "";
        } finally {
          newQuoteBtn.disabled = false;
          newQuoteBtn.textContent = "Get New Quote";
        }
      }

      if (newQuoteBtn) {
        newQuoteBtn.addEventListener("click", getQuote);
      }
    </script>
  </body>
</html>
